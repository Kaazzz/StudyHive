{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ group.group_name }} - Dashboard</title>
    <link rel="stylesheet" href="{% static 'css/output.css' %}">
    <link rel="stylesheet" href="/static/css/general.css?">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">    
</head>

<body class = "m-0 p-0 bg-[#f7f7f7]" style="font-family: 'Poppins', sans-serif; transition: background-color 0.5s ease, color 0.5s ease;">
    {% include 'header.html' %}

    {% include 'sidebar.html' %}

    <main style="margin-left: 220px; padding: 100px 30px 20px;">
        {% include 'group_navbar.html' %}

        <div class="group-dashboard-container bg-gray-100 dark:bg-gray-900 p-6 rounded-lg shadow-md"
        style = "margin-left: 180px; margin-right:180px;">
            <h1 class="dashboard-title yellow-gradient p-4 text-4xl font-bold text-gray-800 dark:text-white mb-4 rounded-md">
                Welcome to <span>{{ group.group_name }}</span>'s <br>
                {% if group.is_private %}
                    Private 
                {% endif %}
                Group Dashboard:
            </h1>
            <div class="dashboard-content space-y-3">
                <p class="dashboard-description text-lg text-gray-700 dark:text-gray-300">
                    <strong>Description:</strong> {{ group.description }}
                </p>
                <p class="dashboard-subject text-lg text-gray-700 dark:text-gray-300">
                    <strong>Subject:</strong> {{ group.subject }}
                </p>
                <p class="dashboard-members text-lg text-gray-700 dark:text-gray-300">
                    <strong>Members:</strong> {{ group.members.count }}
                </p>
                <p class="dashboard-unique_id text-lg text-gray-700 dark:text-gray-300">
                    <strong>ID:</strong> {{ group.unique_id }}
                </p>
            </div>
            
            <div class="dashboard-actions mt-6">
                <a 
                    href="{% url 'edit_group' group.unique_id %}" 
                    class="action-btn text-white py-2 px-4 mr-2 rounded shadow-md transition-all duration-300"
                    style="background: linear-gradient(to right, #FFBB00, #E9B033);"
                    onmouseover="this.style.background = 'linear-gradient(to left, #1A1A1B, #353437)';" 
                    onmouseout="this.style.background ='linear-gradient(to right, #FFBB00, #E9B033)';">
                    Edit Group Details
                </a>
                <button 
                    class="action-btn text-white py-2 px-4 rounded shadow-md transition-all duration-300"
                    style="--tw-bg-opacity: 1; background: linear-gradient(to left, #ef4444, #E9B033);"
                    onmouseover="this.style.background = 'linear-gradient(to left, #1A1A1B, #353437)';" 
                    onmouseout="this.style.background ='linear-gradient(to left, #ef4444, #E9B033)';"
                    onclick="openDeleteModal()">
                    Delete Group
                </button>
            </div>
        </div>
    </main>

    <!-- Modal Structure -->
    <!-- Modal Structure -->
    <div id="deleteModal" 
        class="fixed inset-0 bg-gray-100 flex items-center justify-center hidden"
        onclick="closeDeleteModal(event)"
        style="--tw-bg-opacity: 0.8;">
        <div class="bg-white rounded-lg shadow-lg w-96 p-6"
            onclick="event.stopPropagation()"> <!-- Prevents closing when clicking inside modal -->
            <h2 class="text-xl font-bold text-gray-800 mb-4">Confirm Deletion</h2>
            <p class="text-gray-600 mb-6">
                Are you sure you want to delete this group? This action cannot be undone.
            </p>
            <div class="flex justify-end space-x-4">
                <!-- Cancel Button -->
                <button 
                    class="bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 px-4 rounded mr-2"
                    onclick="closeDeleteModal()">
                    Cancel
                </button>
                <!-- Confirm Delete Button -->
                <form method="POST" action="{% url 'delete_group' group.unique_id %}">
                    {% csrf_token %}
                    <button 
                        type="submit" 
                        class="bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded shadow-md">
                        Confirm
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- JavaScript for Modal -->
    <script>
        function openDeleteModal() {
            const modal = document.getElementById('deleteModal');
            modal.classList.remove('hidden');
            document.body.classList.add('overflow-hidden'); // Prevent scrolling when modal is open
        }

        function closeDeleteModal(event = null) {
            if (event) {
                const modalContent = document.querySelector('#deleteModal > div');
                if (modalContent.contains(event.target)) {
                    return; // Don't close if clicking inside the modal content
                }
            }
            const modal = document.getElementById('deleteModal');
            modal.classList.add('hidden');
            document.body.classList.remove('overflow-hidden'); // Re-enable scrolling
        }
    </script>
</body>
</html>
