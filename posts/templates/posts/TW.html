{% load static %}


<!DOCTYPE html>
<html lang="en">
<head>
  <link href="{% static 'css/output.css' %}" rel="stylesheet">
  <meta charset="UTF-8">
  <title>Posts with Comments</title>
  <style>
    ul {
    /* Remove default list style */
    list-style-type: none;
    /* Add some padding for better spacing */
    padding: 0;
    }

    h1 {
    font-size: 2em;
    margin-bottom: 10px;
    }

    h2 {
    font-size: 1.5em;
    margin-top: 10px;
    }


    button {
    background-color: #eee;
    border: none;
    padding: 5px 10px;
    border-radius: 3px;
    cursor: pointer;
    }

    button:hover {
    background-color: #ddd;
    }

    .post {
      border: 1px solid #ddd;
      padding: 10px;
      margin-bottom: 15px;
    }
    .post-title {
      font-weight: bold;
    }
    .comment {
      margin-left: 20px;
      padding: 5px;
      border-left: 1px solid #eee;
    }
    .comment-author {
      font-style: italic;
    }

    .post {
    border-color: #ccc;
    background-color: #fafafa;
    }

    .comment {
    border-left-color: #ddd;
    background-color: #f5f5f5;
    }

    .post-author, .comment-author {
    color: #333;
    font-weight: bold;
    }
  </style>
</head>
<body>
  <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
    Launch demo modal
  </button>
  
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          ...
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary">Save changes</button>
        </div>
      </div>
    </div>
  </div>

  <h1>Posts with Comments</h1>
  <h1>Welcome {{ user.username }}</h1>

  <form action="{% url 'create_post' %}" method="post">
    {% csrf_token %}
    <button type="submit">Create A Post</button>
  </form>
  
  {% if posts %}
  <ul>
    {% for post in posts %}
    <li class="post">
      <h2 class="post-title">{{ post.title }}</h2>
      <p>{{ post.description }}</p>
      <p>By: {{ post.author.username }} on {{ post.created_at }}</p>
      {% if post.comments.all %}
      <h3>Comments</h3>
      <ul>
        {% for comment in post.comments.all %}
        <li class="comment">
          <p>{{ comment.text }}</p>
          <p class="comment-author">By: {{ comment.author.username }} on {{ comment.created_at }}</p>
        </li>
        {% endfor %}
      </ul>
      {% else %}
      <p>No comments yet.</p>
      {% endif %}
  
      <form action="{% url 'comment_post' post.pk %}" method="post">
        {% csrf_token %}
        <button type="submit">Add Comment</button>
      </form>
  
    </li>
    {% endfor %}
  </ul>
  {% else %}
  <p>There are no posts yet.</p>
  {% endif %}


  <div class="h-screen flex flex-col">
    <div class="bg-gray-100 p-4 flex items-center">
        <img src="user.jpg" alt="User Avatar" class="w-12 h-12 rounded-full mr-4">
        <div>
            <h2 class="text-lg font-semibold">John Doe</h2>
            <p class="text-gray-500">Last seen 2 minutes ago</p>
        </div>
        <div class="flex-grow"></div>
        <button class="text-gray-500 hover:text-gray-700 mr-2"><i class="fas fa-video"></i></button>
        <button class="text-gray-500 hover:text-gray-700"><i class="fas fa-phone"></i></button>
    </div>

    <div class="flex-grow overflow-y-auto p-4">
        <div class="flex justify-end">
            <div class="bg-blue-500 text-white p-3 rounded-tl-none rounded-br rounded-bl-lg">
                <p>Hi John, how are you?</p>
                <p class="text-xs text-gray-300">12:34 PM</p>
            </div>
        </div>

        <div class="flex justify-start">
            <div class="bg-gray-200 p-3 rounded-tr-none rounded-bl rounded-br-lg">
                <p>I'm doing well, thanks! How about you?</p>
                <p class="text-xs text-gray-300">12:35 PM</p>
            </div>
        </div>

        </div>

    <div class="bg-white p-4 border-t border-gray-200 flex">
        <input type="text" placeholder="Type a message" class="flex-grow border border-gray-300 p-2 rounded-l-lg">
        <button class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-r-lg">Send</button>
    </div>
</div>

{% if chats %}
<div class="flex flex-col space-y-4 bg-gray-100 rounded-md p-4 shadow-md">
  <ul class="overflow-y-auto h-full">
    {% for chat in chats %}
      <li class="flex items-center p-2 rounded-md border border-gray-300 hover:bg-gray-200">
        <div class="flex flex-col flex-grow">
          <h2 class="text-lg font-bold text-gray-800">{{ chat.title }}</h2>
          <p class="text-gray-600">{{ chat.description }}</p>
          <p class="text-sm text-gray-500">
            By: {{ chat.author.username }} on {{ chat.created_at }}
          </p>

          {% if chat.comments.all %}
            <div class="mt-4">
              <h3 class="text-md font-medium text-gray-800">Messages</h3>
              <ul class="list-none space-y-2">
                {% for comment in chat.comments.all %}
                  <li class="flex items-start p-2 rounded-md border border-gray-300 hover:bg-gray-200">
                    <img
                      class="w-8 h-8 rounded-full mr-2"
                      src="{{ comment.author.avatar_url }}"
                      alt="{{ comment.author.username }}"
                    />
                    <div class="flex flex-col">
                      <p class="text-gray-800">{{ comment.text }}</p>
                      <p class="text-sm text-gray-500">
                        By: {{ comment.author.username }} on {{ comment.created_at }}
                      </p>
                    </div>
                  </li>
                {% endfor %}
              </ul>
            </div>
          {% else %}
            <p class="text-sm text-gray-500 mt-2">No messages yet.</p>
          {% endif %}
        </div>

        <form
          action="{% url 'send_message' chat.pk %}"
          method="post"
          class="flex items-center mt-4"
        >
          {% csrf_token %}
          <input
            type="text"
            class="w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:border-blue-500 placeholder:text-gray-400"
            placeholder="Write a message"
          />
          <button type="submit" class="ml-2 px-3 py-2 rounded-md bg-blue-500 text-white hover:bg-blue-600">
            Send Message
          </button>
        </form>
      </li>
    {% endfor %}
  </ul>
</div>
{% else %}
<p class="text-gray-600 text-center">There are no chat rooms yet.</p>
{% endif %}

</body>
</html>

